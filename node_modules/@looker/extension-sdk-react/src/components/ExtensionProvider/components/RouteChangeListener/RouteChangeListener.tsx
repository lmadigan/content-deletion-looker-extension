import React from 'react'
import { useLocation } from 'react-router-dom'
import { RouteChangeListenerProps } from './types'
import { ExtensionHostApi } from '@looker/extension-sdk'

export const RouteChangeListener: React.FC<RouteChangeListenerProps> = ({ onPathnameChange, extensionHost }) => {
  let location = useLocation()
  React.useEffect(() => {
    if (onPathnameChange) {
      onPathnameChange(location.pathname)
    }
    ;(extensionHost as ExtensionHostApi).clientRouteChanged(location.pathname + location.search)
  }, [location])
  return <></>
}
